{"version":3,"sources":["consumer-object.js","consumer.js"],"names":[],"mappings":"0tBAIa,uBAAA,0BAMT,wBAAY,IAAZ,CAAkB,QAAlB,CAA4B,sCACxB,KAAK,gBAAL,CAAsB,IAAtB,EACA,KAAK,YAAL,CAAoB,QAApB,CACH,sFAMgB,KAAM,CACnB,IAAI,KAAO,OAAO,IAAP,CAAY,IAAZ,CAAX,CAEA,IAAK,IAAI,CAAT,IAAc,IAAd,CAAoB,CAChB,GAAI,KAAK,cAAL,CAAoB,CAApB,CAAJ,CAA4B,CACxB,IAAI,IAAM,KAAK,CAAL,CAAV,CACA,KAAK,GAAL,EAAY,KAAK,GAAL,CAAZ,CACH,CACJ,CACJ;gmBC5BL,+CACA,oMAOa,iBAAA,oBAUT,kBAAY,QAAZ,CAAsB,WAAtB,CAAmC,+CAC/B,KAAK,QAAL,CAAgB,QAAhB,CACA,KAAK,WAAL,CAAmB,WAAnB,CAEA,KAAK,MAAL,CAAc,6BAAiB,SAAjB,CAA2B,WAAK,CAC1C,EAAE,WAAF,CAAc,MAAK,QAAnB,EACH,CAFa,CAAd,CAIA,6BACH,8DAOiB,KAAX,IAAW,+CAAJ,EAAI,cACd,OAAO,KAAK,OAAL,CAAa,QAAb,CAAuB,IAAvB,CAA6B,EAA7B,CAAP,CACH,kCAQ0B,KAAvB,IAAuB,+CAAhB,EAAgB,kBAAZ,KAAY,+CAAJ,EAAI,cACvB,OAAO,KAAK,OAAL,CAAa,KAAb,CAAoB,IAApB,CAA0B,KAA1B,CAAP,CACH,sCAQ2B,KAAtB,IAAsB,+CAAf,EAAe,kBAAX,IAAW,+CAAJ,EAAI,cACxB,OAAO,KAAK,OAAL,CAAa,OAAb,CAAsB,IAAtB,CAA4B,IAA5B,CAAP,CACH,oCAQ0B,KAAtB,IAAsB,+CAAf,EAAe,kBAAX,IAAW,+CAAJ,EAAI,cACvB,OAAO,KAAK,OAAL,CAAa,MAAb,CAAqB,IAArB,CAA2B,IAA3B,CAAP,CACH,kCAQyB,KAAtB,IAAsB,+CAAf,EAAe,kBAAX,IAAW,+CAAJ,EAAI,cACtB,OAAO,KAAK,OAAL,CAAa,KAAb,CAAoB,IAApB,CAA0B,IAA1B,CAAP,CACH,yCAQO,OAAQ,KAAM,KAAM,CACxB,IAAI,IAAM,KAAK,QAAL,CAAgB,IAA1B,CACA,OAAO,KAAK,MAAL,CAAY,MAAZ,EAAoB,GAApB,CAAyB,IAAzB,EACF,IADE,CACG,KAAK,cAAL,CAAoB,IAApB,CAAyB,IAAzB,CADH,EAEF,KAFE,CAEI,KAAK,aAAL,CAAmB,IAAnB,CAAwB,IAAxB,CAFJ,CAAP,CAGH,uDAQc,KAAM,CACjB,OAAO,KAAK,KAAL,CAAW,KAAK,QAAhB,CAAP,CACH,qCAOK,KAAM,CACR,IAAI,OAAS,KAAK,KAAL,CAAW,IAAX,CAAb,CAEA,GAAI,MAAM,OAAN,CAAc,MAAd,CAAJ,CAA2B,CACvB,OAAO,KAAK,SAAL,CAAe,MAAf,CAAP,CACH,CACD,OAAO,KAAK,WAAL,CAAiB,MAAjB,CAAP,CACH,6CAOS,MAAO,CACb,IAAI,KAAO,EAAX,CADa,gGAGb,kBAAmB,KAAnB,oHAA0B,KAAjB,MAAiB,aACtB,KAAK,IAAL,CAAU,IAAI,KAAK,WAAT,CAAqB,MAArB,CAA6B,IAA7B,CAAV,EACH,CALY,iMAMb,OAAO,IAAP,CACH,iDAOW,OAAQ,CAChB,OAAO,IAAI,KAAK,WAAT,CAAqB,MAArB,CAA6B,IAA7B,CAAP,CACH,qDAQa,KAAM,CAChB,OAAO,IAAP,CACH","file":"ConsumerJS.js","sourcesContent":["/**\n * Base class for object derived from Consumer\n * @abstract\n */\nexport class ConsumerObject {\n    /**\n     * Creates a new object\n     * @param {Object} data Data to parse\n     * @param {Consumer} consumer Consumer instance for this object\n     */\n    constructor(data, consumer) {\n        this.createFromObject(data);\n        this.__consumer__ = consumer;\n    }\n\n    /**\n     * Populates object with data consumed in data\n     * @param {Object} data Data to parse\n     */\n    createFromObject(data) {\n        let keys = Object.keys(data);\n\n        for (let i in keys) {\n            if (keys.hasOwnProperty(i)) {\n                let key = keys[i];\n                this[key] = data[key];\n            }\n        }\n    }\n}","import { HttpClient } from 'aurelia/http-client';\nimport { initialize } from 'aurelia/pal-browser';\n\n\n/**\n * Instantiate to request API endpoints\n * @class\n */\nexport class Consumer {\n    /**\n     * Constructor\n     * Sets this.endpoint to endpoint\n     * Sets this.objectClass to objectClass\n     * Sets this.client to new configured HttpClient\n     * Initializes Aurelia browser abstraction\n     * @param {String} endpoint Base endpoint for this API\n     * @param {ConsumerObject} objectClass Class to cast results to\n     */\n    constructor(endpoint, objectClass) {\n        this.endpoint = endpoint;\n        this.objectClass = objectClass;\n\n        this.client = new HttpClient().configure(x => {\n            x.withBaseUrl(this.endpoint);\n        });\n\n        initialize();\n    }\n\n    /**\n     * Performs a DELETE request\n     * @param {String} path Path on the endpoint\n     * @returns {Promise}\n     */\n    delete(path = '') {\n        return this.request('delete', path, {});\n    }\n\n    /**\n     * Performs a GET request\n     * @param {String} path Path on the endpoint\n     * @param {Object} query Query parameters\n     * @returns {Promise}\n     */\n    get(path = '', query = {}) {\n        return this.request('get', path, query);\n    }\n\n    /**\n     * Performs a PATCH request\n     * @param {String} path Path on the endpoint\n     * @param {Object} data Data payload\n     * @returns {Promise}\n     */\n    patch(path = '', data = {}) {\n        return this.request('patch', path, data);\n    }\n\n    /**\n     * Performs a POST request\n     * @param {String} path Path on the endpoint\n     * @param {Object} data Data payload\n     * @returns {Promise}\n     */\n    post(path = '', data = {}) {\n        return this.request('post', path, data);\n    }\n\n    /**\n     * Performs a PUT request\n     * @param {String} path Path on the endpoint\n     * @param {Object} data Data payload\n     * @returns {Promise}\n     */\n    put(path = '', data = {}) {\n        return this.request('put', path, data);\n    }\n\n    /**\n     * Performs a request\n     * @param {String} method The method to use\n     * @param {String} path Path on the endpoint\n     * @param {Object} data Data payload\n     */\n    request(method, path, data) {\n        let url = this.endpoint + path;\n        return this.client[method](url, data)\n            .then(this.requestSuccess.bind(this))\n            .catch(this.requestFailed.bind(this));\n    }\n\n    /**\n     * Callback for request\n     * Gets called if request resolve successfully\n     * @param {HttpResponseMessage} data\n     * @returns {ConsumerObject|ConsumerObject[]}\n     */\n    requestSuccess(data) {\n        return this.parse(data.response);\n    }\n\n    /**\n     * Parses JSON string to a single or list of ConsumerObject instance(s)\n     * @param {String} data\n     * @returns {ConsumerObject|ConsumerObject[]}\n     */\n    parse(json) {\n        let object = JSON.parse(json);\n\n        if (Array.isArray(object)) {\n            return this.parseList(object);\n        }\n        return this.parseScalar(object);\n    }\n\n    /**\n     * Parses anonymous objects to a list of ConsumerObjects\n     * @param {Object[]} array\n     * @returns {ConsumerObject[]}\n     */\n    parseList(array) {\n        let list = [];\n\n        for (let object of array) {\n            list.push(new this.objectClass(object, this));\n        }\n        return list;\n    }\n\n    /**\n     * Parses anonymous object to a single ConsumerObject\n     * @param {Object} object\n     * @returns {ConsumerObject}\n     */\n    parseScalar(object) {\n        return new this.objectClass(object, this);\n    }\n\n    /**\n     * Callback for request\n     * Gets called if request doesnt resolve successfully\n     * @param {HttpResponseMessage} data\n     * @returns {HttpResponseMessage} data\n     */\n    requestFailed(data) {\n        return data;\n    }\n}"]}